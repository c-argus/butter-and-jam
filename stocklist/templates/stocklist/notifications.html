<!DOCTYPE html>
<html>
<head>
    <title>Notifications</title>
</head>
<body>
    <h1>Notifications</h1>

    <!-- Check if there are any notifications -->
    {% if notifications %}
    <!-- Table to display notifications -->
    <table>
        <!-- Table header section -->
        <thead>
            <!-- Table row for column headings -->
            <tr>
                <!-- Column headings -->
                <th>Item Name</th>        <!-- Item column -->
                <th>Message</th>     <!-- Message column -->
                <th>Created At</th>  <!-- Created At column -->
                <th>Status</th>        <!-- Read column -->
                <th>Action</th>        <!-- Read column -->
            </tr>
        </thead>
        <!-- Table body section -->
        <tbody>
            <!-- Iterate over each notification -->
            {% for notification in notifications %}
            <!-- Table row for each notification -->
            <tr>
                <!-- Notification details columns -->
                <td>{{ notification.item.name }}</td>   <!-- Display item name -->
                <td>{{ notification.message }}</td>     <!-- Display notification message -->
                <td>{{ notification.created_at }}</td>  <!-- Display creation date -->
                <td>
                    {% if notification.read %}
                        Read
                    {% else %}
                        Unread
                    {% endif %}
                </td>        <!-- Display read status -->
                <td><button class="markAsReadButton" data-id="{{notification.id}}">Mark as read</button></td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <!-- Display message if no notifications are available -->
    <p>No notifications available</p>
    {% endif %}

    <!-- Link to go back to the home page -->
    <a href="{% url 'home' %}">Back to Home</a>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            console.log('Ready!')
            const buttonELs = [...document.querySelectorAll('.markAsReadButton')]
            buttonELs.forEach(buttonEl => {
                buttonEl.addEventListener('click', async (e) => {
                    console.log('markAsReadButton!!', )
                    const notificationId = e.target.dataset.id;
                    const response = await fetch(`/notifications/mark_as_read/${notificationId}/`, {
                        method: "POST",
                        headers: {
                            'Content-Type': 'application/json',
                        },
                    })
                    location.reload()
                })
            });
        })
    </script>
</body>
</html>


